---
phase: 13-ml-trajectory-prediction
plan: 06
type: execute
wave: 3
depends_on: ["13-05"]
files_modified:
  - headhunter-ui/src/components/Candidate/TrajectoryPrediction.tsx
  - headhunter-ui/src/components/Candidate/SkillAwareCandidateCard.tsx
  - headhunter-ui/src/types/search.ts
  - headhunter-ui/src/components/Candidate/ConfidenceIndicator.tsx
autonomous: false

must_haves:
  truths:
    - "UI displays predicted next role with confidence percentage"
    - "UI displays tenure prediction range"
    - "UI displays hireability score"
    - "Low confidence predictions show warning indicator"
  artifacts:
    - path: "headhunter-ui/src/components/Candidate/TrajectoryPrediction.tsx"
      provides: "Trajectory prediction display component"
      exports: ["TrajectoryPrediction"]
    - path: "headhunter-ui/src/components/Candidate/ConfidenceIndicator.tsx"
      provides: "Confidence badge with warning state"
      exports: ["ConfidenceIndicator"]
  key_links:
    - from: "headhunter-ui/src/components/Candidate/SkillAwareCandidateCard.tsx"
      to: "headhunter-ui/src/components/Candidate/TrajectoryPrediction.tsx"
      via: "import"
      pattern: "TrajectoryPrediction"
---

<objective>
Create UI components for displaying ML trajectory predictions on candidate cards

Purpose: Display next role predictions, tenure estimates, and hireability scores to recruiters. Low-confidence predictions (< 60%) show visual warning per TRAJ-07 requirement.

Output: Candidate cards display ML trajectory predictions with confidence indicators.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-ml-trajectory-prediction/13-RESEARCH.md
@.planning/phases/13-ml-trajectory-prediction/13-05-SUMMARY.md
@headhunter-ui/src/components/Candidate/SkillAwareCandidateCard.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend search types and create confidence indicator</name>
  <files>
    headhunter-ui/src/types/search.ts
    headhunter-ui/src/components/Candidate/ConfidenceIndicator.tsx
  </files>
  <action>
Extend types and create confidence indicator component:

1. Update `headhunter-ui/src/types/search.ts`:
   - Add `MLTrajectoryPrediction` interface:
     - nextRole: string
     - nextRoleConfidence: number (0-1)
     - tenureMonths: { min: number; max: number }
     - hireability: number (0-1)
     - lowConfidence: boolean
     - uncertaintyReason?: string
   - Extend `SearchResultCandidate` (or similar type):
     - Add optional `mlTrajectory?: MLTrajectoryPrediction`

2. Create `headhunter-ui/src/components/Candidate/ConfidenceIndicator.tsx`:
   - Props: { confidence: number; showWarning?: boolean; size?: 'sm' | 'md' }
   - Display confidence as percentage badge:
     - Green (bg-green-100 text-green-800) for >= 80%
     - Yellow (bg-yellow-100 text-yellow-800) for 60-79%
     - Red (bg-red-100 text-red-800) for < 60%
   - If showWarning && confidence < 60%:
     - Add warning icon (ExclamationTriangleIcon from heroicons)
     - Add tooltip explaining low confidence
   - Use Tailwind CSS for styling
   - Export named `ConfidenceIndicator` component
  </action>
  <verify>
    - `npm run typecheck --prefix headhunter-ui`
    - Check types: `grep -n "MLTrajectoryPrediction" headhunter-ui/src/types/search.ts`
  </verify>
  <done>Types extended with ML predictions, confidence indicator component created</done>
</task>

<task type="auto">
  <name>Task 2: Create trajectory prediction display component</name>
  <files>
    headhunter-ui/src/components/Candidate/TrajectoryPrediction.tsx
  </files>
  <action>
Create comprehensive trajectory prediction display:

1. Create `headhunter-ui/src/components/Candidate/TrajectoryPrediction.tsx`:
   - Props: { prediction: MLTrajectoryPrediction | null | undefined }
   - If no prediction, return null (graceful handling)

   - Display structure:
     ```
     [Next Role Section]
     "Predicted Next: Staff Engineer" (78%)
     - Arrow icon + next role text
     - ConfidenceIndicator badge

     [Tenure Section]
     "Likely to stay: 18-24 months"
     - Clock icon + tenure range

     [Hireability Section]
     "Hireability: High" (or Medium/Low)
     - Star icon + hireability level
     - Convert 0-1 score to label:
       - >= 0.7: "High likelihood to join"
       - >= 0.4: "Moderate likelihood"
       - < 0.4: "Lower likelihood"

     [Uncertainty Warning]
     If lowConfidence:
     - Yellow warning banner
     - Display uncertaintyReason text
     - Example: "Limited career history data"
     ```

   - Use Tailwind CSS:
     - Compact layout for card integration
     - Responsive text sizes
     - Consistent spacing with existing card components

   - Export named `TrajectoryPrediction` component
  </action>
  <verify>
    - `npm run typecheck --prefix headhunter-ui`
    - Check component: `grep -n "uncertaintyReason" headhunter-ui/src/components/Candidate/TrajectoryPrediction.tsx`
  </verify>
  <done>TrajectoryPrediction component displays next role, tenure, and hireability</done>
</task>

<task type="auto">
  <name>Task 3: Integrate trajectory prediction into candidate card</name>
  <files>
    headhunter-ui/src/components/Candidate/SkillAwareCandidateCard.tsx
  </files>
  <action>
Wire trajectory prediction into existing candidate card:

1. Update `headhunter-ui/src/components/Candidate/SkillAwareCandidateCard.tsx`:
   - Import TrajectoryPrediction component
   - Access mlTrajectory from candidate props
   - Add TrajectoryPrediction to card layout:
     - Position: Below existing trajectory/career info section
     - Conditional render: Only if mlTrajectory exists
     - Section divider for visual separation

   - Layout suggestion:
     ```jsx
     {candidate.mlTrajectory && (
       <div className="mt-3 pt-3 border-t border-gray-100">
         <h4 className="text-xs font-medium text-gray-500 mb-2">
           ML Trajectory Prediction
         </h4>
         <TrajectoryPrediction prediction={candidate.mlTrajectory} />
       </div>
     )}
     ```

   - Ensure backward compatibility:
     - Card renders correctly without mlTrajectory
     - No errors if prediction is null/undefined

   - Test visually with and without ML predictions
  </action>
  <verify>
    - `npm run build --prefix headhunter-ui`
    - `npm run typecheck --prefix headhunter-ui`
    - Check integration: `grep -n "TrajectoryPrediction" headhunter-ui/src/components/Candidate/SkillAwareCandidateCard.tsx`
  </verify>
  <done>Candidate card displays ML trajectory predictions when available</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
ML trajectory prediction UI components integrated into candidate cards:
- ConfidenceIndicator: Color-coded confidence badge with warning state
- TrajectoryPrediction: Displays next role, tenure, hireability
- Integration into SkillAwareCandidateCard
  </what-built>
  <how-to-verify>
1. Start the UI: `npm run dev --prefix headhunter-ui`
2. Start hh-search-svc and hh-trajectory-svc (if available, or mock data)
3. Perform a search
4. Check candidate cards for:
   - Predicted next role with confidence percentage (e.g., "Senior Engineer -> Staff Engineer (78%)")
   - Tenure prediction (e.g., "Likely to stay 18-24 months")
   - Hireability indicator (High/Medium/Low)
5. If any card has lowConfidence=true:
   - Verify yellow warning banner appears
   - Verify uncertainty reason text displays
6. Verify card still renders correctly without ML predictions (graceful degradation)
  </how-to-verify>
  <resume-signal>Type "approved" if UI displays correctly, or describe issues</resume-signal>
</task>

</tasks>

<verification>
1. TypeScript compiles: `npm run typecheck --prefix headhunter-ui`
2. UI builds: `npm run build --prefix headhunter-ui`
3. ConfidenceIndicator shows correct colors for confidence levels
4. TrajectoryPrediction displays all three predictions
5. Low confidence shows warning banner with reason
6. Candidate cards render correctly with and without ML predictions
7. Human verification confirms visual correctness
</verification>

<success_criteria>
- TRAJ-05: Candidate cards show "Senior Engineer -> Staff Engineer (78%)" style prediction
- TRAJ-06: Tenure prediction displays "Likely to stay 18-24 months"
- TRAJ-07: Low confidence (< 60%) shows warning indicator with explanation
- TRAJ-09: Hireability displays "High/Medium/Low likelihood to join"
- Graceful degradation when mlTrajectory is absent
- Visual design consistent with existing card components
</success_criteria>

<output>
After completion, create `.planning/phases/13-ml-trajectory-prediction/13-06-SUMMARY.md`
</output>
