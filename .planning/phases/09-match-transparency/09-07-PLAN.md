---
phase: 09-match-transparency
plan: 07
type: execute
wave: 4
depends_on: ["09-03", "09-04", "09-06"]
files_modified:
  - headhunter-ui/src/components/Candidate/SkillAwareCandidateCard.tsx
  - headhunter-ui/src/components/Search/SearchResults.tsx
autonomous: false

must_haves:
  truths:
    - "Overall match score visible (0-100) for each candidate"
    - "Signal breakdown expands/collapses correctly"
    - "Sort/filter by signal scores works"
    - "Inferred skills show confidence badges"
    - "Top candidates show LLM rationale"
  artifacts:
    - path: "headhunter-ui/src/components/Candidate/SkillAwareCandidateCard.tsx"
      provides: "Complete transparency features in candidate card"
      contains: "SignalScoreBreakdown"
  key_links:
    - from: "SearchResults"
      to: "SkillAwareCandidateCard"
      via: "props passing"
      pattern: "signalScores|matchRationale"
---

<objective>
Verify all Phase 9 transparency features are working end-to-end. Human checkpoint for visual/functional validation.

Purpose: Validate TRNS-01 through TRNS-04 requirements are satisfied before completing Phase 9.

Output: Visual confirmation that all transparency features render correctly and work as expected.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# All plan summaries
@.planning/phases/09-match-transparency/09-01-SUMMARY.md
@.planning/phases/09-match-transparency/09-02-SUMMARY.md
@.planning/phases/09-match-transparency/09-03-SUMMARY.md
@.planning/phases/09-match-transparency/09-04-SUMMARY.md
@.planning/phases/09-match-transparency/09-05-SUMMARY.md
@.planning/phases/09-match-transparency/09-06-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: TypeScript compilation check</name>
  <files>headhunter-ui/src/**/*.ts, headhunter-ui/src/**/*.tsx</files>
  <action>
Run full TypeScript compilation check for frontend:

```bash
cd headhunter-ui
npm run build
```

Verify:
- No TypeScript errors
- All imports resolve correctly
- Build completes successfully

Also check backend services:
```bash
cd services/hh-search-svc && npm run build
cd services/hh-rerank-svc && npm run build
```
  </action>
  <verify>All three builds complete without errors</verify>
  <done>TypeScript compilation passes in frontend and backend services</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Phase 9 Match Transparency features:
1. SignalScoreBreakdown component showing 12 signals as horizontal bars
2. SkillChip component with confidence badges (High/Likely/Possible)
3. Candidate card with expandable signal breakdown and inferred skill display
4. Sort dropdown (Best Match, Skills, Trajectory, Recency, Seniority)
5. Filter slider for minimum skill score
6. LLM-generated match rationale for top 10 candidates
  </what-built>

  <how-to-verify>
**Start the development server:**
```bash
cd headhunter-ui
npm run dev
```

Navigate to the search page (http://localhost:5173 or similar).

**Test 1: TRNS-01 - Match Score Visible**
1. Perform a search query (e.g., "Senior Python developer")
2. Verify each candidate card shows overall match score (0-100)
3. Score badge should be visible and color-coded (green/yellow/red)

**Test 2: TRNS-02 - Component Scores**
1. On a candidate card, click "Score Breakdown" toggle
2. Verify 12 signal bars appear:
   - Semantic Match, Seniority Level, Specialty Fit, Tech Stack
   - Function Role, Career Trajectory, Company Quality
   - Exact Skills, Inferred Skills, Seniority Alignment, Skill Recency, Company Relevance
3. Bars should be color-coded: green (>70%), yellow (40-70%), red (<40%)
4. Click toggle again to collapse

**Test 3: TRNS-04 - Inferred Skills with Confidence**
1. Find a candidate with inferred skills (may need to check multiple)
2. Verify explicit skills show solid blue styling
3. Verify inferred skills show:
   - High confidence (>=0.8): Green border, "High" badge
   - Medium confidence (0.5-0.79): Orange border, "Likely" badge
   - Low confidence (<0.5): Gray border, "Possible" badge
4. Hover on an inferred skill - tooltip should show reasoning

**Test 4: Sort/Filter Controls**
1. Use the "Sort by" dropdown:
   - Select "Skills Match" - verify cards reorder by skill score
   - Select "Career Trajectory" - verify cards reorder by trajectory
2. Use the filter slider:
   - Set "Min Skill Score" to 50%
   - Verify candidates below 50% skill score are hidden
3. Click "Clear filter" - verify all candidates return

**Test 5: TRNS-03 - LLM Rationale (top 10)**
1. Look at top 10 candidates
2. Verify "Why This Candidate Matches" section appears with:
   - AI icon (sparkle emoji or similar)
   - Summary paragraph
   - Key strengths as bullets
   - Signal highlights (if present)
3. Look at candidate #11+ - rationale section should NOT appear

**Test 6: Persistence**
1. Reload the page
2. Verify sort/filter settings persist from localStorage

**Expected appearance:**
- Clean, professional design consistent with existing UI
- Smooth animations on expand/collapse
- Responsive layout on mobile (controls stack)
  </how-to-verify>

  <resume-signal>
Type one of:
- "approved" - All tests pass
- "issues: [describe problems]" - Describe any issues found
  </resume-signal>
</task>

<task type="auto">
  <name>Task 3: Document Phase 9 completion</name>
  <files>.planning/STATE.md</files>
  <action>
Update STATE.md to mark Phase 9 as complete:

1. Update Current Position:
```
**Phase:** 9 of 10 (Match Transparency) - COMPLETE
**Plan:** 7 of 7 complete (09-01 through 09-07)
**Status:** Phase complete, verified
```

2. Update Phase Progress table:
```
| 9 | Match Transparency | Complete | 7/7 | 100% |
```

3. Update Progress bar:
```
**Progress:** [█████████░] 90%
```

4. Add to Key Decisions:
```
| Signal breakdown collapsed by default | Progressive disclosure - reduces clutter | 9.01 |
| Confidence thresholds: 0.8/0.5 | High >= 0.8, Medium 0.5-0.79, Low < 0.5 per research | 9.02 |
| Sort persistence in localStorage | UX preference - recruiters don't re-set each session | 9.04 |
| Rationale for top 10 only | Cost optimization - recruiters rarely look past top 10 | 9.05 |
```

5. Add to Technical Notes:
```
- **SignalScoreBreakdown**: 12 signals rendered as horizontal progress bars
- **SkillChip**: Confidence badges for inferred skills
- **Sort/filter controls**: localStorage persistence with hh_search_ prefix
- **LLM rationale**: Cached in Redis with 24h TTL
```
  </action>
  <verify>STATE.md updated with Phase 9 completion status</verify>
  <done>Phase 9 documented as complete in STATE.md</done>
</task>

</tasks>

<verification>
1. TypeScript compilation passes in frontend and both backend services
2. Human checkpoint verifies all TRNS requirements:
   - TRNS-01: Match score visible
   - TRNS-02: Component scores shown with expand/collapse
   - TRNS-03: LLM rationale for top 10
   - TRNS-04: Inferred skills with confidence badges
3. Sort/filter functionality works correctly
4. localStorage persistence verified
5. STATE.md updated with completion status
</verification>

<success_criteria>
Per ROADMAP.md Phase 9 Success Criteria:
1. Search results UI shows overall match score (0-100) for each candidate
2. Expandable score breakdown shows individual signal scores
3. Top 10 candidates have LLM-generated "Why this candidate matches" rationale
4. Inferred skills appear with confidence badge (High: >0.8, Medium: 0.5-0.8, Low: <0.5)
5. Recruiters can sort/filter by individual signal scores
</success_criteria>

<output>
After completion, create `.planning/phases/09-match-transparency/09-07-SUMMARY.md`
</output>
