---
phase: 09-match-transparency
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - headhunter-ui/src/types/index.ts
  - headhunter-ui/src/components/Match/SignalScoreBreakdown.tsx
  - headhunter-ui/src/components/Match/SignalScoreBreakdown.css
autonomous: true

must_haves:
  truths:
    - "Signal score breakdown component renders all 12 signals as horizontal bars"
    - "Color coding shows green (>70%), yellow (40-70%), red (<40%) for signal values"
    - "Expand/collapse state toggles signal visibility"
  artifacts:
    - path: "headhunter-ui/src/types/index.ts"
      provides: "SignalScores and SignalWeightConfig frontend types"
      contains: "SignalScores"
    - path: "headhunter-ui/src/components/Match/SignalScoreBreakdown.tsx"
      provides: "Signal score breakdown React component"
      exports: ["SignalScoreBreakdown"]
    - path: "headhunter-ui/src/components/Match/SignalScoreBreakdown.css"
      provides: "Styling for signal bars and color coding"
      contains: "signal-bar"
  key_links:
    - from: "headhunter-ui/src/components/Match/SignalScoreBreakdown.tsx"
      to: "SignalScores interface"
      via: "props type"
      pattern: "signalScores.*SignalScores"
---

<objective>
Create frontend type definitions and the SignalScoreBreakdown component to display individual signal scores as horizontal progress bars with color coding.

Purpose: Enable recruiters to see how each scoring signal contributed to the candidate's overall match score.

Output: SignalScoreBreakdown component that renders 12 signal scores with visual bars, tooltips, and expand/collapse functionality.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase research findings on what backend returns
@.planning/phases/09-match-transparency/09-RESEARCH.md

# Existing frontend types to extend
@headhunter-ui/src/types/index.ts

# Backend types to mirror (SignalScores, SignalWeightConfig)
@services/hh-search-svc/src/types.ts
@services/hh-search-svc/src/signal-weights.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add SignalScores types to frontend</name>
  <files>headhunter-ui/src/types/index.ts</files>
  <action>
Add frontend type definitions that mirror the backend SignalScores interface.

**IMPORTANT:** Verify SearchResponse and CandidateMatch types include signalScores at the RESULT level (not nested under candidate):
- signalScores is on `SearchResultItem.signalScores` (not `SearchResultItem.candidate.signalScores`)
- See backend `HybridSearchResultItem` in services/hh-search-svc/src/types.ts for authoritative structure

```typescript
/**
 * Signal scores from multi-signal scoring framework.
 * All values are 0-1 normalized.
 */
export interface SignalScores {
  vectorSimilarity: number;
  levelMatch: number;
  specialtyMatch: number;
  techStackMatch: number;
  functionMatch: number;
  trajectoryFit: number;
  companyPedigree: number;
  skillsMatch?: number;
  // Phase 7 signals
  skillsExactMatch?: number;
  skillsInferred?: number;
  seniorityAlignment?: number;
  recencyBoost?: number;
  companyRelevance?: number;
}

/**
 * Signal weight configuration for scoring.
 * Weights should sum to 1.0.
 */
export interface SignalWeightConfig {
  vectorSimilarity: number;
  levelMatch: number;
  specialtyMatch: number;
  techStackMatch: number;
  functionMatch: number;
  trajectoryFit: number;
  companyPedigree: number;
  skillsMatch?: number;
  skillsExactMatch?: number;
  skillsInferred?: number;
  seniorityAlignment?: number;
  recencyBoost?: number;
  companyRelevance?: number;
}
```

Also extend `CandidateMatch` interface to include:
- `signalScores?: SignalScores`
- `weightsApplied?: SignalWeightConfig`
- `roleTypeUsed?: string`
  </action>
  <verify>`npx tsc --noEmit` passes in headhunter-ui directory</verify>
  <done>Frontend types for SignalScores and SignalWeightConfig defined and exported</done>
</task>

<task type="auto">
  <name>Task 2: Create SignalScoreBreakdown component</name>
  <files>
    headhunter-ui/src/components/Match/SignalScoreBreakdown.tsx
    headhunter-ui/src/components/Match/SignalScoreBreakdown.css
  </files>
  <action>
Create a new React component that displays signal scores as horizontal bars:

1. Create directory: `headhunter-ui/src/components/Match/`

2. Create `SignalScoreBreakdown.tsx`:
   - Props: `{ signalScores: SignalScores; weightsApplied?: SignalWeightConfig; expanded?: boolean; onToggle?: () => void }`
   - Display all 12 signals as horizontal bars with names
   - Signal names mapping (display-friendly):
     - vectorSimilarity -> "Semantic Match"
     - levelMatch -> "Seniority Level"
     - specialtyMatch -> "Specialty Fit"
     - techStackMatch -> "Tech Stack"
     - functionMatch -> "Function Role"
     - trajectoryFit -> "Career Trajectory"
     - companyPedigree -> "Company Quality"
     - skillsMatch -> "Skills Overall"
     - skillsExactMatch -> "Exact Skills"
     - skillsInferred -> "Inferred Skills"
     - seniorityAlignment -> "Seniority Alignment"
     - recencyBoost -> "Skill Recency"
     - companyRelevance -> "Company Relevance"
   - Each bar shows: name, score (0-100%), visual bar
   - Color coding based on score: green (>=70%), yellow (40-69%), red (<40%)
   - Tooltip on hover showing weight applied (if available)
   - Use MUI Tooltip component for consistency with existing UI
   - Default collapsed state shows top 3 signals; expanded shows all

3. Create `SignalScoreBreakdown.css`:
   - `.signal-breakdown` container with padding
   - `.signal-row` flexbox layout for label + bar
   - `.signal-bar` with background for track, inner div for fill
   - `.signal-bar.excellent`, `.signal-bar.good`, `.signal-bar.fair` color classes
   - Smooth transition on bar fill width
   - `.collapsed` modifier to hide extra signals
  </action>
  <verify>
Create test file or manually verify component renders:
- `npm run build` succeeds
- Component imported without errors
  </verify>
  <done>SignalScoreBreakdown component renders 12 signals with horizontal bars and color coding</done>
</task>

<task type="auto">
  <name>Task 3: Verify API search request includes transparency fields</name>
  <files>
    headhunter-ui/src/services/api.ts
    headhunter-ui/src/components/Search/SearchPage.tsx
  </files>
  <action>
Verify and update the API integration to ensure signalScores flow from backend to frontend:

1. **In headhunter-ui/src/services/api.ts**, check the `searchWithEngine` method:
   - Verify the response type maps `signalScores` from backend
   - Ensure `SearchResponse.matches` includes signalScores at result level (not nested under candidate)

2. **In headhunter-ui/src/components/Search/SearchPage.tsx**, verify:
   - The `apiService.searchWithEngine()` call receives signalScores in response
   - SearchResults component receives matches with signalScores populated

3. **Type alignment check**:
   - Backend `HybridSearchResultItem` has signalScores, weightsApplied, roleTypeUsed
   - Frontend `CandidateMatch` must mirror this structure
   - Access pattern should be: `match.signalScores` (NOT `match.candidate.signalScores`)

4. **If response doesn't include signalScores by default**, update search options:
```typescript
const results = await apiService.searchWithEngine(
  selectedEngine,
  jobDescription,
  {
    limit: 50,
    includeSignalScores: true,  // Ensure backend includes signal breakdown
    sourcingStrategy: { ... }
  }
);
```
  </action>
  <verify>
- Console.log first search result to verify: `result.signalScores` exists (not undefined)
- TypeScript compilation passes with no `any` casts for signalScores access
- Network tab shows signalScores in API response JSON
  </verify>
  <done>API integration verified to include signalScores/weightsApplied/roleTypeUsed in search response and correctly typed in frontend</done>
</task>

</tasks>

<verification>
1. Run `npm run build` in headhunter-ui - should complete without errors
2. Import `SignalScores` and `SignalWeightConfig` from types/index.ts - no TypeScript errors
3. Import `SignalScoreBreakdown` from components/Match - no errors
4. Signal score breakdown renders with mock data showing 12 signals as horizontal bars
5. **NEW:** API response includes signalScores at result level (console.log verification)
</verification>

<success_criteria>
1. Frontend types mirror backend SignalScores interface exactly
2. SignalScoreBreakdown component exists and exports correctly
3. Color coding logic: green (>=70%), yellow (40-69%), red (<40%)
4. TypeScript compilation passes
5. Component uses MUI Tooltip for consistency
</success_criteria>

<output>
After completion, create `.planning/phases/09-match-transparency/09-01-SUMMARY.md`
</output>
