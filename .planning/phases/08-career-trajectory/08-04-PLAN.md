---
phase: 08-career-trajectory
plan: 04
type: execute
wave: 3
depends_on: [08-01, 08-02, 08-03]
files_modified:
  - services/hh-search-svc/src/index.ts
autonomous: true

must_haves:
  truths:
    - "All trajectory calculators exported from index.ts"
    - "TypeScript compilation passes across the service"
    - "All unit tests pass"
    - "Success criteria from ROADMAP.md verified"
  artifacts:
    - path: "services/hh-search-svc/src/index.ts"
      provides: "Module exports for trajectory calculators"
      contains: "trajectory-calculators"
  key_links:
    - from: "services/hh-search-svc/src/index.ts"
      to: "services/hh-search-svc/src/trajectory-calculators.ts"
      via: "export statement"
      pattern: "export.*from.*trajectory-calculators"
---

<objective>
Verify Phase 8 implementation against all success criteria and ensure proper module exports.

Purpose: Validate that all TRAJ requirements are met and Phase 8 is ready for production.

Output: Module exports updated, all tests passing, verification evidence documented.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-career-trajectory/08-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update module exports in index.ts</name>
  <files>services/hh-search-svc/src/index.ts</files>
  <action>
Add exports for trajectory calculators to `services/hh-search-svc/src/index.ts`:

```typescript
// Trajectory calculators (Phase 8)
export {
  calculateTrajectoryDirection,
  calculateTrajectoryVelocity,
  classifyTrajectoryType,
  calculateTrajectoryFit,
  computeTrajectoryMetrics,
  mapTitleToLevel,
  LEVEL_ORDER_EXTENDED,
  type TrajectoryDirection,
  type TrajectoryVelocity,
  type TrajectoryType,
  type TrajectoryMetrics,
  type TrajectoryContext,
  type ExperienceEntry,
  type TogetherAITrajectory
} from './trajectory-calculators';
```

Ensure the export is added alongside existing exports (signal-calculators, signal-weights, scoring, types).
  </action>
  <verify>
Run TypeScript compilation:
```bash
cd /Volumes/Extreme\ Pro/myprojects/headhunter/services/hh-search-svc && npx tsc --noEmit
```
No errors should appear.
  </verify>
  <done>
Module exports updated in index.ts. TypeScript compilation passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Run full test suite and verify</name>
  <files>services/hh-search-svc/src/trajectory-calculators.test.ts</files>
  <action>
Run the complete test suite for trajectory calculators and verify all tests pass.

Execute:
```bash
cd /Volumes/Extreme\ Pro/myprojects/headhunter/services/hh-search-svc && npm test -- trajectory-calculators.test.ts --reporter=verbose
```

Expected test groups and counts:
1. `mapTitleToLevel` - 4 tests
2. `calculateTrajectoryDirection` - 9 tests (upward: 3, lateral: 3, downward: 2, edge cases: 4)
3. `calculateTrajectoryVelocity` - 6 tests (fast: 1, normal: 1, slow: 1, fallback: 3)
4. `classifyTrajectoryType` - 9 tests (technical: 2, leadership: 2, pivot: 3, lateral: 3)
5. `calculateTrajectoryFit` - 9 tests (high fit: 2, mismatch: 2, pivot: 1, downward: 2, neutral: 2)
6. `computeTrajectoryMetrics` - 1 test

Total: ~35+ tests passing

Document any failing tests and investigate root cause.
  </action>
  <verify>
Check test output for:
- All tests passing (green)
- No skipped tests
- No TypeScript errors

If tests fail, investigate and fix issues before proceeding.
  </verify>
  <done>
All trajectory calculator tests pass. Test coverage complete for direction, velocity, type, and fit scoring.
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify success criteria from ROADMAP.md</name>
  <files>None (verification task)</files>
  <action>
Verify each success criterion from ROADMAP.md Phase 8:

**Criterion 1: Each candidate has computed trajectory_direction (upward, lateral, downward)**
- Verify: `calculateTrajectoryDirection` function exists and returns correct types
- Check: Unit tests cover all three direction classifications
```bash
grep -n "TrajectoryDirection" /Volumes/Extreme\ Pro/myprojects/headhunter/services/hh-search-svc/src/trajectory-calculators.ts
grep -n "direction.*upward\|lateral\|downward" /Volumes/Extreme\ Pro/myprojects/headhunter/services/hh-search-svc/src/trajectory-calculators.test.ts
```

**Criterion 2: Each candidate has computed trajectory_velocity (fast: <2yr/promo, normal: 2-4yr, slow: >4yr)**
- Verify: `calculateTrajectoryVelocity` function with date-based calculation
- Check: Thresholds match requirements (2yr, 4yr boundaries)
```bash
grep -n "fast\|normal\|slow" /Volumes/Extreme\ Pro/myprojects/headhunter/services/hh-search-svc/src/trajectory-calculators.ts | head -20
```

**Criterion 3: Manager role search ranks candidates with leadership trajectory higher**
- Verify: `calculateTrajectoryFit` scores leadership_track higher when targetTrack='management'
- Check: Unit test "penalizes leadership candidate for technical role" confirms differential scoring
```bash
grep -n "targetTrack.*management\|leadership_track" /Volumes/Extreme\ Pro/myprojects/headhunter/services/hh-search-svc/src/trajectory-calculators.test.ts
```

**Criterion 4: Trajectory type classification appears in candidate data**
- Verify: `classifyTrajectoryType` returns one of four types
- Check: Types exported (technical_growth, leadership_track, lateral_move, career_pivot)
```bash
grep -n "TrajectoryType\|technical_growth\|leadership_track\|lateral_move\|career_pivot" /Volumes/Extreme\ Pro/myprojects/headhunter/services/hh-search-svc/src/trajectory-calculators.ts | head -10
```

**Criterion 5: Trajectory fit score (0-1) reflects alignment between candidate trajectory and role direction**
- Verify: `calculateTrajectoryFit` returns 0-1 normalized score
- Check: Integration with scoring.ts populates `signalScores.trajectoryFit`
```bash
grep -n "trajectoryFit" /Volumes/Extreme\ Pro/myprojects/headhunter/services/hh-search-svc/src/scoring.ts
```

Document verification results for each criterion.
  </action>
  <verify>
All 5 success criteria must be verified with evidence from code and tests.
  </verify>
  <done>
All 5 ROADMAP.md success criteria verified. Phase 8 requirements complete.
  </done>
</task>

</tasks>

<verification>
**Success Criteria Evidence Table:**

| Criterion | Requirement | Implementation | Test Evidence |
|-----------|-------------|----------------|---------------|
| TRAJ-01 | Career direction from title sequence | `calculateTrajectoryDirection()` | Tests: upward, lateral, downward |
| TRAJ-02 | Velocity (fast/normal/slow) | `calculateTrajectoryVelocity()` | Tests: <2yr, 2-4yr, >4yr thresholds |
| TRAJ-03 | Trajectory fit score 0-1 | `calculateTrajectoryFit()` | Tests: scoring matrix coverage |
| TRAJ-04 | Type classification | `classifyTrajectoryType()` | Tests: 4 type classifications |
| SC-3 | Leadership higher for manager | Track alignment scoring | Test: management vs technical fit |

**Build Verification:**
- TypeScript compilation: `npx tsc --noEmit` passes
- Unit tests: All trajectory tests passing
- Module exports: index.ts exports all trajectory functions and types
</verification>

<success_criteria>
- All TRAJ requirements implemented and tested
- Module exports available for external consumers
- TypeScript compilation passes
- All unit tests pass
- Success criteria from ROADMAP.md verified with evidence
- Phase 8 ready for production deployment
</success_criteria>

<output>
After completion, create `.planning/phases/08-career-trajectory/08-04-SUMMARY.md`

Also update:
1. `.planning/STATE.md` - Mark Phase 8 complete
2. `.planning/ROADMAP.md` - Update Phase 8 status to Complete
</output>
