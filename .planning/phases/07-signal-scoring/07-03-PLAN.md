---
phase: 07-signal-scoring
plan: 03
type: execute
wave: 2
depends_on: ["07-01", "07-02"]
files_modified:
  - services/hh-search-svc/src/types.ts
  - services/hh-search-svc/src/signal-weights.ts
autonomous: true

must_haves:
  truths:
    - "SignalScores interface includes 5 new optional fields for Phase 7 signals"
    - "SignalWeightConfig interface includes 5 new optional weight fields"
    - "ROLE_WEIGHT_PRESETS updated with Phase 7 signal weights"
    - "All presets sum to 1.0 after adding new signal weights"
  artifacts:
    - path: "services/hh-search-svc/src/types.ts"
      provides: "Extended SignalScores interface with Phase 7 fields"
      contains: "skillsExactMatch?: number"
    - path: "services/hh-search-svc/src/signal-weights.ts"
      provides: "Extended SignalWeightConfig and updated presets"
      contains: "skillsExactMatch?: number"
  key_links:
    - from: "types.ts SignalScores"
      to: "signal-weights.ts SignalWeightConfig"
      via: "matching field names"
      pattern: "skillsExactMatch|skillsInferred|seniorityAlignment|recencyBoost|companyRelevance"
---

<objective>
Extend type definitions and weight configurations to include the 5 new Phase 7 signals.

Purpose: Make the type system aware of new signals so scoring functions can use them.

Output: Updated types.ts and signal-weights.ts with Phase 7 signal support.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-signal-scoring/07-RESEARCH.md
@.planning/phases/07-signal-scoring/07-01-SUMMARY.md (if exists)
@.planning/phases/07-signal-scoring/07-02-SUMMARY.md (if exists)

Key existing files:
@services/hh-search-svc/src/types.ts - SignalScores interface
@services/hh-search-svc/src/signal-weights.ts - SignalWeightConfig, ROLE_WEIGHT_PRESETS
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend SignalScores interface in types.ts</name>
  <files>services/hh-search-svc/src/types.ts</files>
  <action>
Add 5 new optional fields to the SignalScores interface in types.ts.

Find the existing SignalScores interface (around line 51) and add after the existing skillsMatch field:

```typescript
export interface SignalScores {
  /** Vector similarity from hybrid search (0-1 normalized) */
  vectorSimilarity: number;

  /** Level/seniority match alignment (0-1) */
  levelMatch: number;

  /** Specialty match score (0-1) - backend, frontend, fullstack, etc */
  specialtyMatch: number;

  /** Tech stack compatibility score (0-1) */
  techStackMatch: number;

  /** Function alignment score (0-1) - engineering, product, design, etc */
  functionMatch: number;

  /** Career trajectory fit score (0-1) */
  trajectoryFit: number;

  /** Company pedigree score (0-1) */
  companyPedigree: number;

  /** Skills match score (0-1) - for skill-aware searches, optional */
  skillsMatch?: number;

  // ===== PHASE 7 SIGNALS (all 0-1 normalized, optional) =====

  /**
   * SCOR-02: Skills exact match score (0-1)
   * Measures % of required skills the candidate has
   */
  skillsExactMatch?: number;

  /**
   * SCOR-03: Skills inferred score (0-1)
   * Measures match through related/transferable skills
   */
  skillsInferred?: number;

  /**
   * SCOR-04: Seniority alignment score (0-1)
   * Measures level fit with company tier adjustment
   */
  seniorityAlignment?: number;

  /**
   * SCOR-05: Recency boost score (0-1)
   * Boosts candidates with recent skill usage
   */
  recencyBoost?: number;

  /**
   * SCOR-06: Company relevance score (0-1)
   * Combines company tier, target match, and industry fit
   */
  companyRelevance?: number;
}
```

The new fields are all optional (with ?) to maintain backward compatibility.
  </action>
  <verify>
TypeScript compiles: npx tsc --noEmit --project services/hh-search-svc/tsconfig.json
Verify interface has 12 fields total (7 core + skillsMatch + 5 new Phase 7)
  </verify>
  <done>SignalScores interface extended with 5 Phase 7 signal fields</done>
</task>

<task type="auto">
  <name>Task 2: Extend SignalWeightConfig interface in signal-weights.ts</name>
  <files>services/hh-search-svc/src/signal-weights.ts</files>
  <action>
Add 5 new optional weight fields to the SignalWeightConfig interface.

Find the interface (around line 17) and add after skillsMatch:

```typescript
export interface SignalWeightConfig {
  /** Vector similarity from hybrid search (0-1) */
  vectorSimilarity: number;

  /** Level/seniority match score (0-1) */
  levelMatch: number;

  /** Specialty match score (0-1) - backend, frontend, fullstack, etc */
  specialtyMatch: number;

  /** Tech stack compatibility score (0-1) */
  techStackMatch: number;

  /** Function alignment score (0-1) - engineering, product, design, etc */
  functionMatch: number;

  /** Career trajectory fit score (0-1) */
  trajectoryFit: number;

  /** Company pedigree score (0-1) */
  companyPedigree: number;

  /** Skills match score (0-1) - for skill-aware searches, optional */
  skillsMatch?: number;

  // ===== PHASE 7 WEIGHTS (all 0-1, optional) =====

  /** SCOR-02: Weight for skills exact match signal */
  skillsExactMatch?: number;

  /** SCOR-03: Weight for skills inferred signal */
  skillsInferred?: number;

  /** SCOR-04: Weight for seniority alignment signal */
  seniorityAlignment?: number;

  /** SCOR-05: Weight for recency boost signal */
  recencyBoost?: number;

  /** SCOR-06: Weight for company relevance signal */
  companyRelevance?: number;
}
```
  </action>
  <verify>
TypeScript compiles: npx tsc --noEmit --project services/hh-search-svc/tsconfig.json
Verify interface mirrors SignalScores field names
  </verify>
  <done>SignalWeightConfig interface extended with 5 Phase 7 weight fields</done>
</task>

<task type="auto">
  <name>Task 3: Update ROLE_WEIGHT_PRESETS with Phase 7 weights</name>
  <files>services/hh-search-svc/src/signal-weights.ts</files>
  <action>
Update all 4 role presets to include Phase 7 signal weights. The key principle is:
- Weights must sum to 1.0 (adjust existing weights down slightly to make room)
- IC searches: skillsExactMatch and recencyBoost matter most
- Executive searches: seniorityAlignment and companyRelevance matter most
- Manager searches: balanced across all signals

Replace the ROLE_WEIGHT_PRESETS object:

```typescript
/**
 * Default weight presets for each role type.
 *
 * Phase 7 adds 5 new signals. Existing weights are adjusted proportionally
 * to maintain sum = 1.0 while incorporating new signals.
 *
 * Signal categories:
 * - Semantic: vectorSimilarity
 * - Profile fit: levelMatch, specialtyMatch, techStackMatch, functionMatch
 * - Career: trajectoryFit
 * - Company: companyPedigree, companyRelevance
 * - Skills: skillsMatch, skillsExactMatch, skillsInferred, recencyBoost
 * - Seniority: seniorityAlignment
 */
export const ROLE_WEIGHT_PRESETS: Record<RoleType, SignalWeightConfig> = {
  // Executive searches (C-level, VP, Director)
  // Function, company, and seniority matter most
  executive: {
    // Core signals (adjusted down to make room, ~0.70 total)
    vectorSimilarity: 0.08,
    levelMatch: 0.10,
    specialtyMatch: 0.04,
    techStackMatch: 0.04,
    functionMatch: 0.18,
    trajectoryFit: 0.10,
    companyPedigree: 0.16,
    // Phase 7 signals (~0.30 total)
    skillsExactMatch: 0.02,
    skillsInferred: 0.02,
    seniorityAlignment: 0.12,
    recencyBoost: 0.02,
    companyRelevance: 0.12
  },

  // Manager searches (Engineering Manager, Tech Lead)
  // Balanced across skills, trajectory, and seniority
  manager: {
    // Core signals (~0.70 total)
    vectorSimilarity: 0.10,
    levelMatch: 0.08,
    specialtyMatch: 0.10,
    techStackMatch: 0.08,
    functionMatch: 0.12,
    trajectoryFit: 0.10,
    companyPedigree: 0.12,
    // Phase 7 signals (~0.30 total)
    skillsExactMatch: 0.06,
    skillsInferred: 0.04,
    seniorityAlignment: 0.08,
    recencyBoost: 0.04,
    companyRelevance: 0.08
  },

  // IC searches (Senior, Mid, Junior engineers)
  // Skills and tech stack matter most
  ic: {
    // Core signals (~0.62 total)
    vectorSimilarity: 0.12,
    levelMatch: 0.06,
    specialtyMatch: 0.12,
    techStackMatch: 0.12,
    functionMatch: 0.08,
    trajectoryFit: 0.06,
    companyPedigree: 0.06,
    // Phase 7 signals (~0.38 total - skills-heavy)
    skillsExactMatch: 0.14,
    skillsInferred: 0.08,
    seniorityAlignment: 0.06,
    recencyBoost: 0.08,
    companyRelevance: 0.02
  },

  // Default fallback (balanced)
  default: {
    // Core signals (~0.70 total)
    vectorSimilarity: 0.12,
    levelMatch: 0.08,
    specialtyMatch: 0.10,
    techStackMatch: 0.10,
    functionMatch: 0.10,
    trajectoryFit: 0.08,
    companyPedigree: 0.12,
    // Phase 7 signals (~0.30 total)
    skillsExactMatch: 0.08,
    skillsInferred: 0.04,
    seniorityAlignment: 0.06,
    recencyBoost: 0.04,
    companyRelevance: 0.08
  }
};
```

Also update CORE_SIGNAL_KEYS to include Phase 7 signals:

```typescript
/**
 * All signal keys including Phase 7 signals
 */
const ALL_SIGNAL_KEYS: (keyof SignalWeightConfig)[] = [
  'vectorSimilarity',
  'levelMatch',
  'specialtyMatch',
  'techStackMatch',
  'functionMatch',
  'trajectoryFit',
  'companyPedigree',
  // Phase 7 signals
  'skillsExactMatch',
  'skillsInferred',
  'seniorityAlignment',
  'recencyBoost',
  'companyRelevance'
];
```

Update normalizeWeights() to include Phase 7 signals in the sum calculation.
  </action>
  <verify>
TypeScript compiles: npx tsc --noEmit --project services/hh-search-svc/tsconfig.json
Verify each preset sums to 1.0:
- executive: 0.08+0.10+0.04+0.04+0.18+0.10+0.16+0.02+0.02+0.12+0.02+0.12 = 1.00
- manager: 0.10+0.08+0.10+0.08+0.12+0.10+0.12+0.06+0.04+0.08+0.04+0.08 = 1.00
- ic: 0.12+0.06+0.12+0.12+0.08+0.06+0.06+0.14+0.08+0.06+0.08+0.02 = 1.00
- default: 0.12+0.08+0.10+0.10+0.10+0.08+0.12+0.08+0.04+0.06+0.04+0.08 = 1.00
  </verify>
  <done>ROLE_WEIGHT_PRESETS updated with Phase 7 signals, all presets sum to 1.0</done>
</task>

</tasks>

<verification>
1. TypeScript compiles: npx tsc --noEmit --project services/hh-search-svc/tsconfig.json
2. SignalScores has 5 new optional fields
3. SignalWeightConfig has 5 new optional fields
4. All 4 ROLE_WEIGHT_PRESETS sum to exactly 1.00
5. Field names match between SignalScores and SignalWeightConfig
6. normalizeWeights() includes Phase 7 signals in calculation
</verification>

<success_criteria>
1. types.ts extended with Phase 7 SignalScores fields
2. signal-weights.ts extended with Phase 7 weight fields
3. All ROLE_WEIGHT_PRESETS updated and sum to 1.0
4. normalizeWeights() handles new signals
5. Backward compatible (new fields are optional)
6. All code compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-signal-scoring/07-03-SUMMARY.md`
</output>
