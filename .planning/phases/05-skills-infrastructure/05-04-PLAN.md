---
phase: 05-skills-infrastructure
plan: 04
type: execute
wave: 3
depends_on: ["05-01", "05-02", "05-03"]
files_modified: []
autonomous: true

must_haves:
  truths:
    - "skills-master.ts exists in functions/src/shared/"
    - "Searching for 'JS' normalizes to 'JavaScript' before matching"
    - "Skill lookup by alias returns canonical skill name"
    - "No hardcoded synonym maps remain in refactored files"
    - "TypeScript compiles without errors"
  artifacts:
    - path: "functions/src/shared/skills-master.ts"
      provides: "200+ skills taxonomy"
      contains: "MASTER_SKILLS"
    - path: "functions/src/shared/skills-service.ts"
      provides: "O(1) skill normalization"
      exports: ["normalizeSkillName", "skillsMatch"]
  key_links:
    - from: "functions/src/vector-search.ts"
      to: "functions/src/shared/skills-service.ts"
      via: "normalizeSkillName import"
      pattern: "normalizeSkillName"
    - from: "functions/src/skill-aware-search.ts"
      to: "functions/src/shared/skills-service.ts"
      via: "normalizeSkillName import"
      pattern: "normalizeSkillName"
---

<objective>
Verify Phase 5 Skills Infrastructure is complete and functional.

Purpose: Confirm all requirements are met - skills taxonomy copied, service wrapper created, hardcoded synonyms removed, TypeScript compiles.

Output:
- Verification report confirming all success criteria
- Phase 5 marked as complete
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-skills-infrastructure/05-RESEARCH.md

# Prior plan summaries
@.planning/phases/05-skills-infrastructure/05-01-SUMMARY.md
@.planning/phases/05-skills-infrastructure/05-02-SUMMARY.md
@.planning/phases/05-skills-infrastructure/05-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify skills-master.ts exists with correct content</name>
  <files></files>
  <action>
Run verification commands:

1. **File existence**: `ls -la functions/src/shared/skills-master.ts`
2. **Skills count**: `grep -c "{ id:" functions/src/shared/skills-master.ts` (expect 200+)
3. **Key aliases present**:
   - `grep "aliases.*JS" functions/src/shared/skills-master.ts` (JavaScript)
   - `grep "aliases.*K8s" functions/src/shared/skills-master.ts` (Kubernetes)
   - `grep "aliases.*TS" functions/src/shared/skills-master.ts` (TypeScript)
4. **Exports present**: `grep "export const MASTER_SKILLS" functions/src/shared/skills-master.ts`
  </action>
  <verify>
- skills-master.ts exists
- Contains 200+ skill definitions
- Key aliases (JS, K8s, TS) are present
- MASTER_SKILLS is exported
  </verify>
  <done>
- SKIL-01 VERIFIED: EllaAI skills taxonomy (200+ skills) integrated into search
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify skills-service.ts provides O(1) normalization</name>
  <files></files>
  <action>
Run verification commands:

1. **File existence**: `ls -la functions/src/shared/skills-service.ts`
2. **Map initialization**: `grep "ALIAS_TO_CANONICAL" functions/src/shared/skills-service.ts`
3. **Exports present**:
   - `grep "export function normalizeSkillName" functions/src/shared/skills-service.ts`
   - `grep "export function skillsMatch" functions/src/shared/skills-service.ts`
   - `grep "export function getSkillAliases" functions/src/shared/skills-service.ts`
4. **Re-exports**: `grep "export.*from.*skills-master" functions/src/shared/skills-service.ts`
  </action>
  <verify>
- skills-service.ts exists
- ALIAS_TO_CANONICAL Map is built
- normalizeSkillName, skillsMatch, getSkillAliases are exported
- MASTER_SKILLS re-exported for convenience
  </verify>
  <done>
- SKIL-03 VERIFIED: Skill synonym/alias normalization available via skills-service
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify hardcoded synonyms removed from search files</name>
  <files></files>
  <action>
Run verification commands:

1. **vector-search.ts refactored**:
   - `grep "const synonyms" functions/src/vector-search.ts` (should return nothing)
   - `grep "from.*skills-service" functions/src/vector-search.ts` (should show import)

2. **skill-aware-search.ts refactored**:
   - `grep "synonymMap" functions/src/skill-aware-search.ts` (should return nothing)
   - `grep "private normalizeSkill" functions/src/skill-aware-search.ts` (should return nothing)
   - `grep "from.*skills-service" functions/src/skill-aware-search.ts` (should show import)

3. **Both files use normalizeSkillName**:
   - `grep "normalizeSkillName" functions/src/vector-search.ts`
   - `grep "normalizeSkillName" functions/src/skill-aware-search.ts`
  </action>
  <verify>
- No hardcoded synonyms in vector-search.ts
- No hardcoded synonyms in skill-aware-search.ts
- Both files import from skills-service
- Both files use normalizeSkillName
  </verify>
  <done>
- Hardcoded synonym maps removed from all search files
- Centralized skills service used everywhere
  </done>
</task>

<task type="auto">
  <name>Task 4: Verify TypeScript compilation</name>
  <files></files>
  <action>
Run TypeScript compilation for the functions directory:

```bash
cd functions && npx tsc --noEmit
```

OR if npm scripts are set up:

```bash
npm run typecheck --prefix functions
```

OR if using workspace:

```bash
npm run build --prefix functions
```

Expected: No compilation errors.

If errors occur:
1. Check import paths are correct
2. Check no circular dependencies
3. Check type exports from skills-master.ts are complete
  </action>
  <verify>
- TypeScript compiles without errors
- No type mismatches
- All imports resolve correctly
  </verify>
  <done>
- TypeScript compilation passes
- No type errors in skills infrastructure
  </done>
</task>

</tasks>

<verification>
**Phase 5 Success Criteria Check:**

1. [x] skills-master.ts from EllaAI exists in functions/src/shared/ (copied, not linked)
2. [x] Searching for "JS" normalizes to "JavaScript" before matching
3. [x] Skill lookup by alias returns canonical skill ID
4. [x] Skill taxonomy is accessible from search service without external API call
5. [x] No hardcoded synonym maps remain in vector-search.ts or skill-aware-search.ts
6. [x] TypeScript compiles without errors

**Requirements Verified:**
- SKIL-01: EllaAI skills taxonomy (200+ skills) integrated into search
- SKIL-03: Skill synonym/alias normalization ("JS" = "JavaScript", "K8s" = "Kubernetes")
</verification>

<success_criteria>
- All 4 success criteria from ROADMAP Phase 5 are met
- Both SKIL-01 and SKIL-03 requirements are satisfied
- TypeScript compiles without errors
- No hardcoded synonyms remain in the codebase
</success_criteria>

<output>
After completion, create `.planning/phases/05-skills-infrastructure/05-04-SUMMARY.md`

Also update `.planning/STATE.md` to mark Phase 5 as complete.
</output>
