# Production configuration for headhunter-ai-0088 Cloud Run deployment
PROJECT_ID=headhunter-ai-0088
REGION=us-central1
SECONDARY_REGION=us-central1
ENVIRONMENT=production

# Deployment artifacts
ARTIFACT_REGISTRY=us-central1-docker.pkg.dev/headhunter-ai-0088/headhunter-services
CLOUD_RUN_DOMAIN=headhunter-ai-0088.run.app
BUILD_CACHE_BUCKET=hh-build-cache-us-central1

# Networking
VPC_NAME=vpc-hh
VPC_SUBNET_RUN=hh-run-subnet
VPC_SUBNET_SQL=hh-sql-subnet
VPC_SUBNET_REDIS=hh-redis-subnet
VPC_CONNECTOR=svpc-us-central1
ROUTER_NAME=hh-vpc-router
NAT_GATEWAY_NAME=hh-nat-gateway
CONNECTOR_EGRESS_ALLOWED_CIDRS=0.0.0.0/0
ALLOWED_INGRESS_CIDRS=0.0.0.0/0

# Cloud SQL
SQL_INSTANCE=sql-hh-core
SQL_INSTANCE_MSGS=sql-hh-msgs
SQL_DATABASE=headhunter
SQL_TIER=db-custom-4-15360
SQL_STORAGE_AUTO_GROWTH=true
SQL_STORAGE_SIZE_GB=250
SQL_BACKUP_RETENTION_DAYS=14
SQL_MAINTENANCE_WINDOW_DAY=7
SQL_MAINTENANCE_WINDOW_HOUR=5
SQL_FLAGS=cloudsql.enable_pgvector=true,shared_buffers=6144,max_connections=1200,track_io_timing=on
SQL_USER_APP=embed_writer
SQL_USER_ADMIN=hh_admin
SQL_USER_ANALYTICS=search_reader
SQL_USER_OPERATIONS=msgs_app

# Redis Memorystore
REDIS_INSTANCE=redis-skills-us-central1
REDIS_TIER=STANDARD_HA
REDIS_CAPACITY_GB=12
REDIS_READ_ENDPOINT=10.80.0.12
REDIS_HOST=redis-skills-us-central1
REDIS_PORT=6379

# Pub/Sub
PUBSUB_TOPIC_PROFILES=profiles.refresh.request
PUBSUB_TOPIC_POSTINGS=postings.refresh.request
PUBSUB_TOPIC_ENRICH=enrich.pipeline.request
PUBSUB_TOPIC_ALERTS=system.alerts
PUBSUB_SUBSCRIPTION_PROFILES=profiles.refresh.request.sub
PUBSUB_SUBSCRIPTION_POSTINGS=postings.refresh.request.sub
PUBSUB_SUBSCRIPTION_ENRICH=enrich.pipeline.request.sub
PUBSUB_SUBSCRIPTION_ALERTS=system.alerts.sub

# Secret Manager
SECRET_DB_PRIMARY=db-primary-password
SECRET_DB_REPLICA=db-replica-password
SECRET_DB_ANALYTICS=db-analytics-password
SECRET_DB_OPERATIONS=db-ops-password
SECRET_REDIS_ENDPOINT=redis-endpoint
SECRET_TOGETHER_AI=together-ai-api-key
SECRET_GEMINI_AI=gemini-api-key
SECRET_ADMIN_JWT=admin-jwt-signing-key
SECRET_WEBHOOK=webhook-shared-secret
SECRET_OAUTH_CLIENT=oauth-client-credentials
SECRET_EDGE_CACHE=edge-cache-config

# Service accounts
SVC_EMBED=embed-production
SVC_SEARCH=search-production
SVC_RERANK=rerank-production
SVC_EVIDENCE=evidence-production
SVC_ECO=eco-production
SVC_ENRICH=enrich-production
SVC_ADMIN=admin-production
SVC_MSGS=msgs-production
SVC_PIPELINE=pipeline-production
SVC_MONITORING=monitoring-production

# Cloud Run service names (base names without environment suffix)
RUN_SERVICE_EMBED=hh-embed-svc
RUN_SERVICE_SEARCH=hh-search-svc
RUN_SERVICE_RERANK=hh-rerank-svc
RUN_SERVICE_EVIDENCE=hh-evidence-svc
RUN_SERVICE_ECO=hh-eco-svc
RUN_SERVICE_ENRICH=hh-enrich-svc
RUN_SERVICE_ADMIN=hh-admin-svc
RUN_SERVICE_MSGS=hh-msgs-svc

# Cloud Run scaling defaults
EMBED_MIN_INSTANCES=2
EMBED_MAX_INSTANCES=120
EMBED_CPU=2
EMBED_MEMORY=4Gi
EMBED_CONCURRENCY=4

SEARCH_MIN_INSTANCES=2
SEARCH_MAX_INSTANCES=200
SEARCH_CPU=2
SEARCH_MEMORY=4Gi
SEARCH_CONCURRENCY=32

RERANK_MIN_INSTANCES=1
RERANK_MAX_INSTANCES=80
RERANK_CPU=2
RERANK_MEMORY=3Gi
RERANK_CONCURRENCY=8

EVIDENCE_MIN_INSTANCES=1
EVIDENCE_MAX_INSTANCES=90
EVIDENCE_CPU=2
EVIDENCE_MEMORY=4Gi
EVIDENCE_CONCURRENCY=32

ECO_MIN_INSTANCES=1
ECO_MAX_INSTANCES=60
ECO_CPU=1
ECO_MEMORY=2Gi
ECO_CONCURRENCY=20

ENRICH_MIN_INSTANCES=1
ENRICH_MAX_INSTANCES=40
ENRICH_CPU=4
ENRICH_MEMORY=8Gi
ENRICH_CONCURRENCY=4

ADMIN_MIN_INSTANCES=1
ADMIN_MAX_INSTANCES=20
ADMIN_CPU=1
ADMIN_MEMORY=2Gi
ADMIN_CONCURRENCY=16

MSGS_MIN_INSTANCES=1
MSGS_MAX_INSTANCES=80
MSGS_CPU=2
MSGS_MEMORY=4Gi
MSGS_CONCURRENCY=16

# External integrations
TOGETHER_AI_MODEL=rerank-advanced-v2
TOGETHER_EMBED_MODEL=text-embedding-3-large
TOGETHER_AI_P95_TARGET_MS=350
GEMINI_MODEL=gemini-1.5-pro
ENRICH_PIPELINE_TIMEOUT_SECONDS=110

# Monitoring and alerting
MONITORING_WORKSPACE=headhunter-monitoring
ALERTING_CHANNEL=projects/headhunter-ai-0088/notificationChannels/4707499773465197758
ERROR_BUDGET_POLICY=production-default
LOGGING_SINK=hh-prod-logging-sink

# Reporting
DEPLOYMENT_REPORT_BUCKET=hh-production-deployment-reports

# IAM bindings
ROLE_DATAFLOW=roles/dataflow.developer
ROLE_RUN_ADMIN=roles/run.admin
ROLE_SQL_CLIENT=roles/cloudsql.client
ROLE_SECRET_ACCESS=roles/secretmanager.secretAccessor
ROLE_PUBSUB_ADMIN=roles/pubsub.admin
ROLE_MONITORING_ADMIN=roles/monitoring.admin

# Miscellaneous
DEFAULT_TENANT=headhunter
TENANT_ISOLATION_MODE=strict
